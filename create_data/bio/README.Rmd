---
title: Ingesting object data from a BIO excel file
author: Dan Kelley
date: 2021-05-28
output:
    toc: true
    number_sections: true
---

# Introduction

This directory contains an R file here in which I tried to decode things
automatically.  This proved to be difficult, because the meanings of things
were (I think) indicated by colour underlays, and I don't know how to catch
that nuance in a program.  Also, there were *lots* of weird things in the file,
like text in numeric fields, negative lengths, etc., and so the R file became a
mess of special cases.  So, and partly because this work would not pay off for
other datasets, I decided to drop the idea of decoding the excel file with R,
instead doing the work "by hand" by copying cells into csv files. (In addition
to copying cells, I had to do computations, e.g. converting Newtons to kg.)

For the names of items, I switched from all upper-case to all lower-case, which
is easier to type, and fits with the Dewey names.  I also removed the `"`
symbols, which are hard to type in code, and appear in some instances and not
in others.  And I change groups of multiple spaces into single spaces.

# Details

## `chains_bio.csv`

These are green-background in the excel file, rows 7 through 12.

### `buoyancy`

This is inferred as `NEWTONS` (col E) divided by 9.8 m/s^2 to get kg.
```{r}
N <- c(9.3408,1.46784,0.3336,0.40032,42.3672,445)
round(N/9.8, 3)
```

### `height`

The is copied directly from col B, with 0 for the first 4 entries.

### `width`

This is inferred as the ratio of `A (m*2/m)` (col G) to `LENGTH` (col C)
```{r}
G <- c(NA,NA,NA,NA,0.05715,0.0254)
C <- c(NA,NA,NA,NA,1,1)
length <- round(G/C, 4)
length
```

### `CD`

The `CD` is assigned the value 1.3, matching the Dewey assumption for chain elements. 

### Results

These are in the order of the spreadsheet; note that `chains("?")` merges all
datasets, and orders by name.

```{r}
knitr::kable(read.csv("chains_bio.csv"))
```



## `floats_bio.csv`

These are yellow-background in the excel file.

The first item, named `"new glass streamlined float"`, has no listed weight in
pounds or newtons, so I ignored that entry.

For buoyancy, I took `NEWTONS` (col E) and divided by 9.8m/s^2 to get kg, rounding
to 2 digits after the decimal place.
```{r}
N <- c(445,285,560,516,429,773,414,1886,3963,4030,2095,8224,7740)
round(N/9.8, 2)
```

There are two length columns in the file, but the values are either identical
or relatable by rounding, so I could choose either.  But is that in the x or
the y direction?

Two columns contain things related to area, one with name `A (m*2/m)` and other
with name `AW (m*2)`.  I think the former is the projected area per meter of z
(as it is for wires).  So, if we assume that the length is in the z direction,
or that the object is roughly spherical, we can infer what the package needs,
namely `height` and `diameter`, from the ratio of the second area to the first
length.  Whether that's sensible, I just don't know.
```{r}
A<-c(0.164,0.5,0.073,0.5,0.164,1.5,1.5,1.86,2.84,2.474,1.67,2.7,2.7)
L<-c(0.74,0.563,1,0.563,1.187,1,1,1.286,1.286,1.286,1.286,2.42,2.42)
round(A/L,3)
```

```{r}
f <- read.csv("floats_bio.csv")
o <- order(f$name)
knitr::kable(f[o,])
```

## `instruments_bio.csv`

### Processing

The entry for `DVS CURRENT METER` had height listed as `0.7 (2)`. The
parenthetic value is not explained, and so it is ignored here, perhaps
incurring an error.

The entry for `SBE37 MICROCAT CLAMP-ON STYLE*` (row 33) lists the value `(15)*`
for Newtons, and the value 15N is used here, based on my interpretation of the
footnote.

All names are converted to lower-case, and double spaces are converted to
single spaces.

The entries in rows 34 and 35 seem to refer to one item. I ignore row 34, since
so many things are not filled in for it, and I do not understand what the
meaning is.

The `height` value is copied from the first `LENGTH` column (col C).

The `buoyancy` value is inferred by dividing the `NEWTONS` (col E) by 9.8m/s^2.
```{r}
E <- c(73.392,106.752,131.216,177.92,44.48,200.16,444.8,209.056,199,192,21.8,45.6,600.48,15,144,216)
round(E/9.8, 2)
```

The `area` is computed as the product of `LENGTH` (col C) and `A (m&2/m)` (col G).

The `CD` is assigned the value 0.65, matching the Dewey assumption for floats.

A `code` entry is made, to make this compatible with Dewey values, if I can
find them.

### Results

```{r}
knitr::kable(read.csv("instruments_bio.csv"))
```


## `releases_bio.csv`

Note the ommision of an entry for type `BENTHOS 875 RELEASE`, because it has no
value listed in col G (area `A (m*2/m)`) or col I (area `AW (m*2)`).

### `height`
Use `LENGTH` (col C).

### `buoyancy`
Use the negative of `NEWTONS` (col E), divided by g=9.8m/s^2, rounded to 2 decimal
places.
```{r}
N <- c(149, 253.5, 360,	129, 273, 118.7)
round(N/9.8, 2)
```

### `width`
Use the ratio of `A (m&2/m)` (col G) to `LENGTH` (col C).
```{r}
G <- c(0.14,0.14,0.127,0.112,0.199,0.237)
C <- c(1.194,1.32,1.23,0.68,1,0.4)
width <- round(G/C, 4)
```
Note the `NA` value -- this is "benthos 875 release", which we will not use
here, since there's no point in guessing.  (Put another way, if someone at BIO
wants to take a measuring tape to that thing to find it's diameter, we'll
incorporate it!)

### `CD`
Use 0.65, i.e. Dewey's value for floats, on the assumption that the two might
be similar.

### Result for releases

```{r}
knitr::kable(read.csv("releases_bio.csv"))
```

## wires_bio.csv


### `buoyancyPerMeter`

The 3/16 case has -0.76 in a column named "W Nt/m", so I've converted that to
-0.76/9.8=-0.0776 (rounded to 4 places), to get kg/m instead of N/m.

There is no listing for the 1/4 case, but I estimated (guessed) that as

```{r}
round(-0.0776 * ((4/16)/(3/16))^2, 4)
```
This is based on an assumption that the metal inside is similar, etc.

### `diameter`

For the diameter, I looked at the column labeled `A (m*2/m)`. I assume that is
the horizontally-projected area. To test that, I computed 
```{r}
16*c(0.00635,0.0079375)/0.0254
```
which yields the expected, for the outside diameters in 16-ths of inch.

### `CD`

There are no entries in the file and I did not know what `DRAG -N` and `DRAG
-T` meant and so I just used the value $C_D=1.3$, used in Dewey's work.

### Result for `wires`

```{r}
knitr::kable(read.csv("wires_bio.csv"))
```


